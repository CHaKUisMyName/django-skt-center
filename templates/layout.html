{% load static %}
{% load user_tags %}
{% load org_tags %}
{% load visitor_tag %}
{% load car_schedule_tag %}
{% load welcomeboard_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <meta name="apple-mobile-web-app-capable" content="yes">  -->
    <link rel="apple-touch-icon"
          sizes="180x180"
          href="{% static 'favicon/apple-touch-icon.png' %}">
    <link rel="icon"
          type="image/png"
          sizes="32x32"
          href="{% static 'favicon/favicon-32x32.png' %}">
    <link rel="icon"
          type="image/png"
          sizes="16x16"
          href="{% static 'favicon/favicon-16x16.png' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link href="{% static 'css/app.css' %}" rel="stylesheet" />
    <link href="{% static 'css/fontawesome/css/fontawesome.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/fontawesome/css/brands.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/fontawesome/css/solid.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/datatables.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/dataTables.bootstrap5.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/tempus-dominus.css' %}" />
    <link href="{% static 'css/custom.css' %}" rel="stylesheet" />
    <link href="{% static 'css/loading.css' %}" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'css/select2.min.css' %}" />
    <link rel="stylesheet"
          href="{% static 'css/select2-bootstrap-5-theme.min.css' %}" />
    <link href="{% static 'css/sweetalert2.min.css' %}" rel="stylesheet">
    
    {% block css %}{% endblock %}
    {% block title %}<title>SKT Center</title>{% endblock %}
</head>
<body>
    <div class="load-screen d-none">
        <span class="loader">Loading</span>
    </div>
    <div class="wrapper">
        <nav id="sidebar" class="sidebar js-sidebar">
            <div class="sidebar-content js-simplebar">
                <a class="sidebar-brand border-bottom" href="{% url 'indexDashboard' %}">
                    <span class="align-middle">SANYO-KASEI</span>
                  </a>
                  <ul class="sidebar-nav">
                    <li class="px-3 my-2 mt-4">
                        <div class="menu-search-wrapper">
                            <i class="bi bi-search menu-search-icon"></i>

                            <input type="search"
                                id="menuSearch"
                                class="menu-search-input"
                                placeholder="Search menu..."
                                autocomplete="off">

                            <span class="menu-search-clear d-none" id="menuSearchClear">
                                <i class="bi bi-x-circle-fill"></i>
                            </span>
                        </div>
                    </li>
                    <li class="sidebar-header pt-0">Page</li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="{% url 'indexDashboard' %}" data-active="dashboard">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="fa-solid fa-house"></i>
                            </div>
                            <span class="fw-bold">Home</span>
                        </a>
                    </li>
                    {% has_menu_csh request.currentUser "Car" as can_view_cshCar %}
                    {% has_menu_csh request.currentUser "Driver" as can_view_cshDriver %}
                    {% has_menu_csh request.currentUser "SettingCarSchedule" as can_view_cshSettingCsh %}
                    
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#carschedule" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-truck-front-fill"></i>
                            </div>
                            <span class="fw-bold">Car Schedule</span>
                        </a>
                        <ul id="carschedule" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexCarSchedule' %}" data-active="csh">Schedule</a>
                            </li>
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'listCarSchedule' %}" data-active="listcsh">Search</a>
                            </li>
                            {% if can_view_cshCar %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexCar' %}" data-active="car">Car</a>
                            </li>
                            {% endif %}
                            {% if can_view_cshDriver %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexDriver' %}" data-active="driver">Driver</a>
                            </li>
                            {% endif %}
                            {% if can_view_cshSettingCsh %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexSettingCsh' %}" data-active="settingcsh">Settings</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>
                    
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="https://app.empeo.com/" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-person-badge-fill"></i>
                            </div>
                            <span class="fw-bold">Empeo System</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.219/eSmart7" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-clipboard-check-fill"></i>
                            </div>
                            <span class="fw-bold">E-Smart System</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="https://portal.systemstone.com/" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-building-fill-gear"></i>
                            </div>
                            <span class="fw-bold">Factorium CMMS</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.230:8080/SCSSY/" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-boxes"></i>
                            </div>
                            <span class="fw-bold">FIFO System</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#user" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-person-fill"></i>
                            </div>
                            <span class="fw-bold">GA System</span>
                        </a>
                        <ul id="user" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            {% has_menu_user request.currentUser "Immigration" as can_view_immuser %}
                            {% if can_view_immuser %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexImmigration' %}" data-active="immigration">Immigration</a>
                            </li>
                            {% endif %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'historyOpd' request.currentUser.id %}" data-active="histories">OPD</a>
                            </li>
                            {% has_menu_user request.currentUser "Opd-Admin" as view_opd_admin %}
                            {% if view_opd_admin %}
                            <li class="sidebar-item my-2">
                                <a href="#opd" data-bs-toggle="collapse" class="sidebar-link">OPD-Admin</a>
                                <ul id="opd" class="sidebar-dropdown list-unstyled collapse parent-menu-collapse">
                                    <li class="sidebar-item my-2">
                                        <a href="{% url 'indexFamily' %}" class="sidebar-link ps-6" data-active="family">Family</a>
                                    </li>
                                    <li class="sidebar-item my-2">
                                        <a href="{% url 'indexOpd' %}" class="sidebar-link ps-6" data-active="opd" onclick="Loading(true)">OPD</a>
                                    </li>
                                    <li class="sidebar-item my-2">
                                        <a href="{% url 'listOpd' %}" class="sidebar-link ps-6" data-active="listopd" onclick="Loading(true)">Search Opd</a>
                                    </li>
                                    <li class="sidebar-item my-2">
                                        <a href="{% url 'buggetSettingOpd' %}" class="sidebar-link ps-6" data-active="budgetsettingopd">Default Budget</a>
                                    </li>
                                    <li class="sidebar-item my-2">
                                        <a href="{% url 'optionSettingOpd' %}" class="sidebar-link ps-6" data-active="optionsettingopd">Option OPD</a>
                                    </li>
                                </ul>
                            </li>
                            {% endif %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexUser' %}" data-active="user">User</a>
                            </li>
                            {% has_menu_user request.currentUser "SettingUser" as can_view_suser %}
                            {% if can_view_suser %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexSettingUser' %}" data-active="settinguser">Settings</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.196/ConMasManager" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-file-earmark-excel-fill"></i>
                            </div>
                            <span class="fw-bold">I-Reporter</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.206/" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-ticket-detailed-fill"></i>
                            </div>
                            <span class="fw-bold">IT Ticket</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.230:8080/SANYOLAB/login.jsf" target="_blank" data-active="lims">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-droplet-half"></i>
                            </div>
                            <span class="fw-bold">LIMS System</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#mainorg" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-diagram-3-fill"></i>
                            </div>
                            <span class="fw-bold">Organization</span>
                        </a>
                        <ul id="mainorg" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexLevel' %}" data-active="level">Level</a>
                            </li>
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexOrg' %}" data-active="org">Organization</a>
                            </li>
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexPosition' %}" data-active="pos">Position</a>
                            </li>
                            {% has_menu_org request.currentUser "SettingOrg" as can_view_sOrg %}
                            {% if can_view_sOrg %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexSettingOrg' %}" data-active="settingorg">Settings</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="{% url 'indexReminder' %}" data-active="reminder">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-envelope"></i>
                            </div>
                            <span class="fw-bold">Reminder</span>
                        </a>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#mainsafety" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-shield-shaded"></i>
                            </div>
                            <span class="fw-bold">Safety System</span>
                        </a>
                        <ul id="mainsafety" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexGreenCard' %}" data-active="greenyellowcard">Green/Yellow Card</a>
                            </li>
                        </ul>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="http://192.168.1.214" target="_blank" data-active="sds">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-file-earmark-text-fill"></i>
                            </div>
                            <span class="fw-bold">SDS</span>
                        </a>
                    </li>
                    
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#visitor" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-book-fill"></i>
                            </div>
                            <span class="fw-bold">Visitor</span>
                        </a>
                        <ul id="visitor" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexVisitor' %}" data-active="visitor">Visitor</a>
                            </li>
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'listVisitor' %}" data-active="vstlist">Search</a>
                            </li>
                            {% has_menu_vst request.currentUser "Option" as can_view_vstOption %}
                            {% if can_view_vstOption %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexOption' %}" data-active="option">Option</a>
                            </li>
                            {% endif %}
                            {% has_menu_vst request.currentUser "Room" as can_view_vstRoom %}
                            {% if can_view_vstRoom %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexRoom' %}" data-active="room">Room</a>
                            </li>
                            {% endif %}
                            {% has_menu_vst request.currentUser "SettingVisitorOption" as can_view_vstSettingOption %}
                            {% if can_view_vstSettingOption %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexSettingVst' %}" data-active="settingvisitor">Settings</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>
                    {% has_menu_welcomboard request.currentUser "Guest" as can_view_wbGuest %}
                    {% has_menu_welcomboard request.currentUser "SettingWelcomeBoard" as can_view_wbSetting %}
                    {% if can_view_wbGuest or can_view_wbSetting %}
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#welcomeboard" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-display-fill"></i>
                            </div>
                            <span class="fw-bold">Welcome Board</span>
                        </a>
                        <ul id="welcomeboard" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexWelcomeBoard' %}" data-active="welguest">Guest</a>
                            </li>
                            {% if can_view_wbSetting %}
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexSettingWelcomeBoard' %}" data-active="settingwb">Settings</a>
                            </li>
                            {% endif %}
                        </ul>
                    </li>
                    {% endif %}
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="https://sanyokaseithailand.com:8443/login" target="_blank" data-active="esmart">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-truck"></i>
                            </div>
                            <span class="fw-bold">WMS</span>
                        </a>
                    </li>
                    
                    {% if request.currentUser.isAdmin == True %}
                    <li class="sidebar-item my-2 mx-3">
                        <a data-bs-target="#system" data-bs-toggle="collapse" class="sidebar-link">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-gear-fill"></i>
                            </div>
                            <span class="fw-bold">System Settings</span>
                        </a>
                        <ul id="system" class="parent-menu-collapse sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexApp' %}" data-active="appname">App Name Setting</a>
                            </li>
                            <li class="sidebar-item my-2">
                                <a class="sidebar-link" href="{% url 'indexMenu' %}" data-active="menu">System Menu Setting</a>
                            </li>
                        </ul>
                    </li>
                    <li class="sidebar-item my-2 mx-3">
                        <a class="sidebar-link" href="{% url 'indexDeploy' %}" data-active="deploy">
                            <div class="p-2 bg-white icon-link shadow-lg rounded-2 me-2">
                                <i class="bi bi-cloud-upload-fill"></i>
                            </div>
                            <span class="fw-bold">Deploy</span>
                        </a>
                    </li>
                    {% endif %}
                  </ul>
            </div>
        </nav>
        <div class="main">
            <nav class="navbar navbar-expand navbar-light">
                <a class="sidebar-toggle js-sidebar-toggle">
                    <i class="hamburger align-self-center"></i>
                </a>
                {% block breadcrumb %}{% endblock %}
                <div class="navbar-collapse collapse">
                    <ul class="navbar-nav navbar-align">
                        <li class="nav-item dropdown">
                            {% if request.currentUser %}
                            <a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#" data-bs-toggle="dropdown">
                                <!-- <i class="bi bi-person"></i> -->
                                 <img id="prf-sm" src="{% static 'images/profile-icon.png' %}" class="avatar img-fluid rounded me-2" alt="...">
                            </a>
                            <a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#" data-bs-toggle="dropdown">
                                <!-- <i class="bi bi-person"></i> -->
                                 <img id="prf-md" src="{% static 'images/profile-icon.png' %}" class="avatar img-fluid rounded me-2" alt="...">
                                <span>{{ request.currentUser.email }}</span>
                            </a>
							<div class="dropdown-menu dropdown-menu-end">
								<a class="dropdown-item" href="{% url 'editUser' request.currentUser.id %}"><i class="align-middle me-1" data-feather="user"></i> Profile</a>
								<div class="dropdown-divider"></div>
								<a id="loguot" class="dropdown-item" href="{% url 'logout' %}">Logout</a>
							</div>
                            {% endif %}
						</li>
                    </ul>
                </div>
            </nav>
            <main class="content">
                <div class="container-fluid p-0">
                    {% block content %}{% endblock %}
                </div>
            </main>
        </div>
    </div>
    <script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
    <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/app.js'%}"></script>
    <script src="{% static 'js/custom.js'%}"></script>
    <script src="{% static 'js/select2.min.js' %}"></script>
    <script src="{% static 'js/moment.js' %}"></script>
    <script src="{% static 'js/moment-timezone-with-data.js' %}"></script>
    <script src="{% static 'js/fullcalendar.min.js' %}"></script>
    <script src="{% static 'js/sweetalert2.all.min.js' %}"></script>
    <script src="{% static 'js/datatables.min.js' %}"></script>
    <script src="{% static 'js/dataTables.bootstrap5.js' %}"></script>
    <script src="{% static 'js/tempus-dominus.js' %}"></script>
    <script src="https://cdnjs.com/libraries/Chart.js"></script>
    <script type="text/JavaScript">
        function ActiveMenu(menu) {
            if ($('#menuSearch').val().trim() !== '') return;
            // à¸¥à¸š Active à¸­à¸­à¸à¸ˆà¸²à¸à¸—à¸¸à¸à¹€à¸¡à¸™à¸¹à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸š data-active
            $('.sidebar-link:not([data-active="' + menu + '"])').parent().removeClass('active');
            // à¹€à¸žà¸´à¹ˆà¸¡ Active à¹ƒà¸«à¹‰à¹€à¸¡à¸™à¸¹à¸—à¸µà¹ˆà¸–à¸¹à¸à¹€à¸¥à¸·à¸­à¸
            let activeLink = $('.sidebar-link[data-active="' + menu + '"]');
            activeLink.parent().addClass('active');

            // -- active menu à¸—à¸µà¹ˆà¸¡à¸µ menu à¸¢à¹ˆà¸­à¸¢
            if(activeLink.parents().hasClass('parent-menu-collapse')){
              // -- show collapse à¹à¸¥à¸° active menu à¹à¸¡à¹ˆ
              activeLink.parents('.parent-menu-collapse').addClass('show');
              activeLink.parents('.parent-menu-collapse').parent().addClass('active');
            }else{
              // -- close collapse à¹à¸¥à¸° remove active
              $('.parent-menu-collapse').removeClass('show');
              $('.parent-menu-collapse').parent().removeClass('active');
            }
        }
        function Loading(params) {
            if(params){
            $('.load-screen').removeClass('d-none');
            }else{
            $('.load-screen').addClass('d-none');
            }
        }
        $("#loguot").click(function(){
            Loading(true);
        });
        $(document).ready(function(){
            const profileImg = '{{ request.currentUser.imgProfilePath }}';
            if(profileImg && profileImg != "" && profileImg != "None"){
                const profileImgURL = window.location.origin + '/media/'+ profileImg + '?t=' + new Date().getTime();
                $('#prf-sm').attr('src', profileImgURL);
                $('#prf-md').attr('src', profileImgURL);
            }
        });
        $('#menuSearch').on('input', function () {
            let keyword = $(this).val().toLowerCase().trim();

            $('.sidebar-nav > .sidebar-item').each(function () {
                let item = $(this);
                let parentLink = item.find('> .sidebar-link');
                let parentText = parentLink.text().toLowerCase();
                let subMenu = item.find('.parent-menu-collapse');
                let hasSubMenu = subMenu.length > 0;

                let childMatched = false;
                item.find('.parent-menu-collapse .sidebar-link').each(function () {
                    if ($(this).text().toLowerCase().includes(keyword)) {
                        childMatched = true;
                    }
                });

                // ðŸ”„ clear search â†’ show à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” (à¹„à¸¡à¹ˆà¹à¸•à¸° active)
                if (keyword === '') {
                    if(subMenu.hasClass('show') && item.hasClass('active')){
                        item.show();
                        subMenu.addClass('show');
                        subMenu.find('.sidebar-item').show();
                    }else{
                        item.show();
                        subMenu.removeClass('show');
                    }
                    return;
                }

                // ðŸ” match à¹€à¸¡à¸™à¸¹à¹à¸¡à¹ˆ â†’ show + à¹€à¸›à¸´à¸”à¸¥à¸¹à¸à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
                if (parentText.includes(keyword)) {
                    item.show();
                    if (hasSubMenu) {
                        subMenu.addClass('show');
                        subMenu.find('.sidebar-item').show();
                    }
                    return;
                }

                // ðŸ” match à¹€à¸¡à¸™à¸¹à¸¥à¸¹à¸ â†’ show + à¹€à¸›à¸´à¸”à¹€à¸¡à¸™à¸¹à¹à¸¡à¹ˆ
                if (childMatched) {
                    item.show();
                    subMenu.addClass('show');
                    return;
                }

                // âŒ à¹„à¸¡à¹ˆ match
                item.hide();
            });
        });

        const $menuSearch = $('#menuSearch');
        const $menuSearchClear = $('#menuSearchClear');

        $menuSearch.on('input', function () {
            let hasValue = $(this).val().trim() !== '';
            $menuSearchClear.toggleClass('d-none', !hasValue);
        });

        // click âŒ clear
        $menuSearchClear.on('click', function () {
            $menuSearch.val('').trigger('input').focus();
        });


        /** @license
         * DHTML Snowstorm! JavaScript-based snow for web pages
         * Making it snow on the internets since 2003. You're welcome.
         * -----------------------------------------------------------
         * Version 1.44.20131208 (Previous rev: 1.44.20131125)
         * Copyright (c) 2007, Scott Schiller. All rights reserved.
         * Code provided under the BSD License
         * http://schillmania.com/projects/snowstorm/license.txt
         */

        /*jslint nomen: true, plusplus: true, sloppy: true, vars: true, white: true */
        /*global window, document, navigator, clearInterval, setInterval */

        var snowStorm = (function(window, document) {

        // --- common properties ---

        this.autoStart = true;          // Whether the snow should start automatically or not.
        this.excludeMobile = true;      // Snow is likely to be bad news for mobile phones' CPUs (and batteries.) Enable at your own risk.
        this.flakesMax = 128;           // Limit total amount of snow made (falling + sticking)
        this.flakesMaxActive = 64;      // Limit amount of snow falling at once (less = lower CPU use)
        this.animationInterval = 50;    // Theoretical "miliseconds per frame" measurement. 20 = fast + smooth, but high CPU use. 50 = more conservative, but slower
        this.useGPU = true;             // Enable transform-based hardware acceleration, reduce CPU load.
        this.className = null;          // CSS class name for further customization on snow elements
        this.excludeMobile = true;      // Snow is likely to be bad news for mobile phones' CPUs (and batteries.) By default, be nice.
        this.flakeBottom = null;        // Integer for Y axis snow limit, 0 or null for "full-screen" snow effect
        this.followMouse = false;        // Snow movement can respond to the user's mouse
        this.snowColor = '#fff';        // Don't eat (or use?) yellow snow.
        this.snowCharacter = '&bull;';  // &bull; = bullet, &middot; is square on some systems etc.
        this.snowStick = true;          // Whether or not snow should "stick" at the bottom. When off, will never collect.
        this.targetElement = null;      // element which snow will be appended to (null = document.body) - can be an element ID eg. 'myDiv', or a DOM node reference
        this.useMeltEffect = true;      // When recycling fallen snow (or rarely, when falling), have it "melt" and fade out if browser supports it
        this.useTwinkleEffect = false;  // Allow snow to randomly "flicker" in and out of view while falling
        this.usePositionFixed = false;  // true = snow does not shift vertically when scrolling. May increase CPU load, disabled by default - if enabled, used only where supported
        this.usePixelPosition = false;  // Whether to use pixel values for snow top/left vs. percentages. Auto-enabled if body is position:relative or targetElement is specified.

        // --- less-used bits ---

        this.freezeOnBlur = true;       // Only snow when the window is in focus (foreground.) Saves CPU.
        this.flakeLeftOffset = 0;       // Left margin/gutter space on edge of container (eg. browser window.) Bump up these values if seeing horizontal scrollbars.
        this.flakeRightOffset = 0;      // Right margin/gutter space on edge of container
        this.flakeWidth = 8;            // Max pixel width reserved for snow element
        this.flakeHeight = 8;           // Max pixel height reserved for snow element
        this.vMaxX = 5;                 // Maximum X velocity range for snow
        this.vMaxY = 4;                 // Maximum Y velocity range for snow
        this.zIndex = 0;                // CSS stacking order applied to each snowflake

        // --- "No user-serviceable parts inside" past this point, yadda yadda ---

        var storm = this,
        features,
        // UA sniffing and backCompat rendering mode checks for fixed position, etc.
        isIE = navigator.userAgent.match(/msie/i),
        isIE6 = navigator.userAgent.match(/msie 6/i),
        isMobile = navigator.userAgent.match(/mobile|opera m(ob|in)/i),
        isBackCompatIE = (isIE && document.compatMode === 'BackCompat'),
        noFixed = (isBackCompatIE || isIE6),
        screenX = null, screenX2 = null, screenY = null, scrollY = null, docHeight = null, vRndX = null, vRndY = null,
        windOffset = 1,
        windMultiplier = 2,
        flakeTypes = 6,
        fixedForEverything = false,
        targetElementIsRelative = false,
        opacitySupported = (function(){
            try {
            document.createElement('div').style.opacity = '0.5';
            } catch(e) {
            return false;
            }
            return true;
        }()),
        didInit = false,
        docFrag = document.createDocumentFragment();

        features = (function() {

            var getAnimationFrame;

            /**
             * hat tip: paul irish
             * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
             * https://gist.github.com/838785
             */

            function timeoutShim(callback) {
            window.setTimeout(callback, 1000/(storm.animationInterval || 20));
            }

            var _animationFrame = (window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame ||
                timeoutShim);

            // apply to window, avoid "illegal invocation" errors in Chrome
            getAnimationFrame = _animationFrame ? function() {
            return _animationFrame.apply(window, arguments);
            } : null;

            var testDiv;

            testDiv = document.createElement('div');

            function has(prop) {

            // test for feature support
            var result = testDiv.style[prop];
            return (result !== undefined ? prop : null);

            }

            // note local scope.
            var localFeatures = {

            transform: {
                ie:  has('-ms-transform'),
                moz: has('MozTransform'),
                opera: has('OTransform'),
                webkit: has('webkitTransform'),
                w3: has('transform'),
                prop: null // the normalized property value
            },

            getAnimationFrame: getAnimationFrame

            };

            localFeatures.transform.prop = (
            localFeatures.transform.w3 || 
            localFeatures.transform.moz ||
            localFeatures.transform.webkit ||
            localFeatures.transform.ie ||
            localFeatures.transform.opera
            );

            testDiv = null;

            return localFeatures;

        }());

        this.timer = null;
        this.flakes = [];
        this.disabled = false;
        this.active = false;
        this.meltFrameCount = 20;
        this.meltFrames = [];

        this.setXY = function(o, x, y) {

            if (!o) {
            return false;
            }

            if (storm.usePixelPosition || targetElementIsRelative) {

            o.style.left = (x - storm.flakeWidth) + 'px';
            o.style.top = (y - storm.flakeHeight) + 'px';

            } else if (noFixed) {

            o.style.right = (100-(x/screenX*100)) + '%';
            // avoid creating vertical scrollbars
            o.style.top = (Math.min(y, docHeight-storm.flakeHeight)) + 'px';

            } else {

            if (!storm.flakeBottom) {

                // if not using a fixed bottom coordinate...
                o.style.right = (100-(x/screenX*100)) + '%';
                o.style.bottom = (100-(y/screenY*100)) + '%';

            } else {

                // absolute top.
                o.style.right = (100-(x/screenX*100)) + '%';
                o.style.top = (Math.min(y, docHeight-storm.flakeHeight)) + 'px';

            }

            }

        };

        this.events = (function() {

            var old = (!window.addEventListener && window.attachEvent), slice = Array.prototype.slice,
            evt = {
            add: (old?'attachEvent':'addEventListener'),
            remove: (old?'detachEvent':'removeEventListener')
            };

            function getArgs(oArgs) {
            var args = slice.call(oArgs), len = args.length;
            if (old) {
                args[1] = 'on' + args[1]; // prefix
                if (len > 3) {
                args.pop(); // no capture
                }
            } else if (len === 3) {
                args.push(false);
            }
            return args;
            }

            function apply(args, sType) {
            var element = args.shift(),
                method = [evt[sType]];
            if (old) {
                element[method](args[0], args[1]);
            } else {
                element[method].apply(element, args);
            }
            }

            function addEvent() {
            apply(getArgs(arguments), 'add');
            }

            function removeEvent() {
            apply(getArgs(arguments), 'remove');
            }

            return {
            add: addEvent,
            remove: removeEvent
            };

        }());

        function rnd(n,min) {
            if (isNaN(min)) {
            min = 0;
            }
            return (Math.random()*n)+min;
        }

        function plusMinus(n) {
            return (parseInt(rnd(2),10)===1?n*-1:n);
        }

        this.randomizeWind = function() {
            var i;
            vRndX = plusMinus(rnd(storm.vMaxX,0.2));
            vRndY = rnd(storm.vMaxY,0.2);
            if (this.flakes) {
            for (i=0; i<this.flakes.length; i++) {
                if (this.flakes[i].active) {
                this.flakes[i].setVelocities();
                }
            }
            }
        };

        this.scrollHandler = function() {
            var i;
            // "attach" snowflakes to bottom of window if no absolute bottom value was given
            scrollY = (storm.flakeBottom ? 0 : parseInt(window.scrollY || document.documentElement.scrollTop || (noFixed ? document.body.scrollTop : 0), 10));
            if (isNaN(scrollY)) {
            scrollY = 0; // Netscape 6 scroll fix
            }
            if (!fixedForEverything && !storm.flakeBottom && storm.flakes) {
            for (i=0; i<storm.flakes.length; i++) {
                if (storm.flakes[i].active === 0) {
                storm.flakes[i].stick();
                }
            }
            }
        };

        this.resizeHandler = function() {
            if (window.innerWidth || window.innerHeight) {
            screenX = window.innerWidth - 16 - storm.flakeRightOffset;
            screenY = (storm.flakeBottom || window.innerHeight);
            } else {
            screenX = (document.documentElement.clientWidth || document.body.clientWidth || document.body.scrollWidth) - (!isIE ? 8 : 0) - storm.flakeRightOffset;
            screenY = storm.flakeBottom || document.documentElement.clientHeight || document.body.clientHeight || document.body.scrollHeight;
            }
            docHeight = document.body.offsetHeight;
            screenX2 = parseInt(screenX/2,10);
        };

        this.resizeHandlerAlt = function() {
            screenX = storm.targetElement.offsetWidth - storm.flakeRightOffset;
            screenY = storm.flakeBottom || storm.targetElement.offsetHeight;
            screenX2 = parseInt(screenX/2,10);
            docHeight = document.body.offsetHeight;
        };

        this.freeze = function() {
            // pause animation
            if (!storm.disabled) {
            storm.disabled = 1;
            } else {
            return false;
            }
            storm.timer = null;
        };

        this.resume = function() {
            if (storm.disabled) {
            storm.disabled = 0;
            } else {
            return false;
            }
            storm.timerInit();
        };

        this.toggleSnow = function() {
            if (!storm.flakes.length) {
            // first run
            storm.start();
            } else {
            storm.active = !storm.active;
            if (storm.active) {
                storm.show();
                storm.resume();
            } else {
                storm.stop();
                storm.freeze();
            }
            }
        };

        this.stop = function() {
            var i;
            this.freeze();
            for (i=0; i<this.flakes.length; i++) {
            this.flakes[i].o.style.display = 'none';
            }
            storm.events.remove(window,'scroll',storm.scrollHandler);
            storm.events.remove(window,'resize',storm.resizeHandler);
            if (storm.freezeOnBlur) {
            if (isIE) {
                storm.events.remove(document,'focusout',storm.freeze);
                storm.events.remove(document,'focusin',storm.resume);
            } else {
                storm.events.remove(window,'blur',storm.freeze);
                storm.events.remove(window,'focus',storm.resume);
            }
            }
        };

        this.show = function() {
            var i;
            for (i=0; i<this.flakes.length; i++) {
            this.flakes[i].o.style.display = 'block';
            }
        };

        this.SnowFlake = function(type,x,y) {
            var s = this;
            this.type = type;
            this.x = x||parseInt(rnd(screenX-20),10);
            this.y = (!isNaN(y)?y:-rnd(screenY)-12);
            this.vX = null;
            this.vY = null;
            this.vAmpTypes = [1,1.2,1.4,1.6,1.8]; // "amplification" for vX/vY (based on flake size/type)
            this.vAmp = this.vAmpTypes[this.type] || 1;
            this.melting = false;
            this.meltFrameCount = storm.meltFrameCount;
            this.meltFrames = storm.meltFrames;
            this.meltFrame = 0;
            this.twinkleFrame = 0;
            this.active = 1;
            this.fontSize = (10+(this.type/5)*10);
            this.o = document.createElement('div');
            this.o.innerHTML = storm.snowCharacter;
            if (storm.className) {
            this.o.setAttribute('class', storm.className);
            }
            this.o.style.color = storm.snowColor;
            this.o.style.position = (fixedForEverything?'fixed':'absolute');
            if (storm.useGPU && features.transform.prop) {
            // GPU-accelerated snow.
            this.o.style[features.transform.prop] = 'translate3d(0px, 0px, 0px)';
            }
            this.o.style.width = storm.flakeWidth+'px';
            this.o.style.height = storm.flakeHeight+'px';
            this.o.style.fontFamily = 'arial,verdana';
            this.o.style.cursor = 'default';
            this.o.style.overflow = 'hidden';
            this.o.style.fontWeight = 'normal';
            this.o.style.zIndex = storm.zIndex;
            docFrag.appendChild(this.o);

            this.refresh = function() {
            if (isNaN(s.x) || isNaN(s.y)) {
                // safety check
                return false;
            }
            storm.setXY(s.o, s.x, s.y);
            };

            this.stick = function() {
            if (noFixed || (storm.targetElement !== document.documentElement && storm.targetElement !== document.body)) {
                s.o.style.top = (screenY+scrollY-storm.flakeHeight)+'px';
            } else if (storm.flakeBottom) {
                s.o.style.top = storm.flakeBottom+'px';
            } else {
                s.o.style.display = 'none';
                s.o.style.bottom = '0%';
                s.o.style.position = 'fixed';
                s.o.style.display = 'block';
            }
            };

            this.vCheck = function() {
            if (s.vX>=0 && s.vX<0.2) {
                s.vX = 0.2;
            } else if (s.vX<0 && s.vX>-0.2) {
                s.vX = -0.2;
            }
            if (s.vY>=0 && s.vY<0.2) {
                s.vY = 0.2;
            }
            };

            this.move = function() {
            var vX = s.vX*windOffset, yDiff;
            s.x += vX;
            s.y += (s.vY*s.vAmp);
            if (s.x >= screenX || screenX-s.x < storm.flakeWidth) { // X-axis scroll check
                s.x = 0;
            } else if (vX < 0 && s.x-storm.flakeLeftOffset < -storm.flakeWidth) {
                s.x = screenX-storm.flakeWidth-1; // flakeWidth;
            }
            s.refresh();
            yDiff = screenY+scrollY-s.y+storm.flakeHeight;
            if (yDiff<storm.flakeHeight) {
                s.active = 0;
                if (storm.snowStick) {
                s.stick();
                } else {
                s.recycle();
                }
            } else {
                if (storm.useMeltEffect && s.active && s.type < 3 && !s.melting && Math.random()>0.998) {
                // ~1/1000 chance of melting mid-air, with each frame
                s.melting = true;
                s.melt();
                // only incrementally melt one frame
                // s.melting = false;
                }
                if (storm.useTwinkleEffect) {
                if (s.twinkleFrame < 0) {
                    if (Math.random() > 0.97) {
                    s.twinkleFrame = parseInt(Math.random() * 8, 10);
                    }
                } else {
                    s.twinkleFrame--;
                    if (!opacitySupported) {
                    s.o.style.visibility = (s.twinkleFrame && s.twinkleFrame % 2 === 0 ? 'hidden' : 'visible');
                    } else {
                    s.o.style.opacity = (s.twinkleFrame && s.twinkleFrame % 2 === 0 ? 0 : 1);
                    }
                }
                }
            }
            };

            this.animate = function() {
            // main animation loop
            // move, check status, die etc.
            s.move();
            };

            this.setVelocities = function() {
            s.vX = vRndX+rnd(storm.vMaxX*0.12,0.1);
            s.vY = vRndY+rnd(storm.vMaxY*0.12,0.1);
            };

            this.setOpacity = function(o,opacity) {
            if (!opacitySupported) {
                return false;
            }
            o.style.opacity = opacity;
            };

            this.melt = function() {
            if (!storm.useMeltEffect || !s.melting) {
                s.recycle();
            } else {
                if (s.meltFrame < s.meltFrameCount) {
                s.setOpacity(s.o,s.meltFrames[s.meltFrame]);
                s.o.style.fontSize = s.fontSize-(s.fontSize*(s.meltFrame/s.meltFrameCount))+'px';
                s.o.style.lineHeight = storm.flakeHeight+2+(storm.flakeHeight*0.75*(s.meltFrame/s.meltFrameCount))+'px';
                s.meltFrame++;
                } else {
                s.recycle();
                }
            }
            };

            this.recycle = function() {
            s.o.style.display = 'none';
            s.o.style.position = (fixedForEverything?'fixed':'absolute');
            s.o.style.bottom = 'auto';
            s.setVelocities();
            s.vCheck();
            s.meltFrame = 0;
            s.melting = false;
            s.setOpacity(s.o,1);
            s.o.style.padding = '0px';
            s.o.style.margin = '0px';
            s.o.style.fontSize = s.fontSize+'px';
            s.o.style.lineHeight = (storm.flakeHeight+2)+'px';
            s.o.style.textAlign = 'center';
            s.o.style.verticalAlign = 'baseline';
            s.x = parseInt(rnd(screenX-storm.flakeWidth-20),10);
            s.y = parseInt(rnd(screenY)*-1,10)-storm.flakeHeight;
            s.refresh();
            s.o.style.display = 'block';
            s.active = 1;
            };

            this.recycle(); // set up x/y coords etc.
            this.refresh();

        };

        this.snow = function() {
            var active = 0, flake = null, i, j;
            for (i=0, j=storm.flakes.length; i<j; i++) {
            if (storm.flakes[i].active === 1) {
                storm.flakes[i].move();
                active++;
            }
            if (storm.flakes[i].melting) {
                storm.flakes[i].melt();
            }
            }
            if (active<storm.flakesMaxActive) {
            flake = storm.flakes[parseInt(rnd(storm.flakes.length),10)];
            if (flake.active === 0) {
                flake.melting = true;
            }
            }
            if (storm.timer) {
            features.getAnimationFrame(storm.snow);
            }
        };

        this.mouseMove = function(e) {
            if (!storm.followMouse) {
            return true;
            }
            var x = parseInt(e.clientX,10);
            if (x<screenX2) {
            windOffset = -windMultiplier+(x/screenX2*windMultiplier);
            } else {
            x -= screenX2;
            windOffset = (x/screenX2)*windMultiplier;
            }
        };

        this.createSnow = function(limit,allowInactive) {
            var i;
            for (i=0; i<limit; i++) {
            storm.flakes[storm.flakes.length] = new storm.SnowFlake(parseInt(rnd(flakeTypes),10));
            if (allowInactive || i>storm.flakesMaxActive) {
                storm.flakes[storm.flakes.length-1].active = -1;
            }
            }
            storm.targetElement.appendChild(docFrag);
        };

        this.timerInit = function() {
            storm.timer = true;
            storm.snow();
        };

        this.init = function() {
            var i;
            for (i=0; i<storm.meltFrameCount; i++) {
            storm.meltFrames.push(1-(i/storm.meltFrameCount));
            }
            storm.randomizeWind();
            storm.createSnow(storm.flakesMax); // create initial batch
            storm.events.add(window,'resize',storm.resizeHandler);
            storm.events.add(window,'scroll',storm.scrollHandler);
            if (storm.freezeOnBlur) {
            if (isIE) {
                storm.events.add(document,'focusout',storm.freeze);
                storm.events.add(document,'focusin',storm.resume);
            } else {
                storm.events.add(window,'blur',storm.freeze);
                storm.events.add(window,'focus',storm.resume);
            }
            }
            storm.resizeHandler();
            storm.scrollHandler();
            if (storm.followMouse) {
            storm.events.add(isIE?document:window,'mousemove',storm.mouseMove);
            }
            storm.animationInterval = Math.max(20,storm.animationInterval);
            storm.timerInit();
        };

        this.start = function(bFromOnLoad) {
            if (!didInit) {
            didInit = true;
            } else if (bFromOnLoad) {
            // already loaded and running
            return true;
            }
            if (typeof storm.targetElement === 'string') {
            var targetID = storm.targetElement;
            storm.targetElement = document.getElementById(targetID);
            if (!storm.targetElement) {
                throw new Error('Snowstorm: Unable to get targetElement "'+targetID+'"');
            }
            }
            if (!storm.targetElement) {
            storm.targetElement = (document.body || document.documentElement);
            }
            if (storm.targetElement !== document.documentElement && storm.targetElement !== document.body) {
            // re-map handler to get element instead of screen dimensions
            storm.resizeHandler = storm.resizeHandlerAlt;
            //and force-enable pixel positioning
            storm.usePixelPosition = true;
            }
            storm.resizeHandler(); // get bounding box elements
            storm.usePositionFixed = (storm.usePositionFixed && !noFixed && !storm.flakeBottom); // whether or not position:fixed is to be used
            if (window.getComputedStyle) {
            // attempt to determine if body or user-specified snow parent element is relatlively-positioned.
            try {
                targetElementIsRelative = (window.getComputedStyle(storm.targetElement, null).getPropertyValue('position') === 'relative');
            } catch(e) {
                // oh well
                targetElementIsRelative = false;
            }
            }
            fixedForEverything = storm.usePositionFixed;
            if (screenX && screenY && !storm.disabled) {
            storm.init();
            storm.active = true;
            }
        };

        function doDelayedStart() {
            window.setTimeout(function() {
            storm.start(true);
            }, 20);
            // event cleanup
            storm.events.remove(isIE?document:window,'mousemove',doDelayedStart);
        }

        function doStart() {
            if (!storm.excludeMobile || !isMobile) {
            doDelayedStart();
            }
            // event cleanup
            storm.events.remove(window, 'load', doStart);
        }

        // hooks for starting the snow
        if (storm.autoStart) {
            storm.events.add(window, 'load', doStart, false);
        }

        return this;

        }(window, document));


    </script>
    {% block script %}{% endblock %}
</body>
</html>